# Holographic Volume Viewer - Usage Guide

## Overview
The `HolographicVolumeViewer` component renders the 3D "Bulk" generated by the `HolographicEngine` using volumetric point cloud visualization.

## Backend Integration

### WebSocket Message
The viewer requests volume data via WebSocket:

```typescript
websocket.send(JSON.stringify({
  type: 'get_bulk_volume',
  ws_id: ws_id
}));
```

### Response Format
```typescript
{
  type: 'bulk_volume_data',
  payload: {
    volume_data: number[],  // Flat array [D * H * W]
    depth: number,          // D dimension
    height: number,         // H dimension  
    width: number,          // W dimension
    step: number            // Current simulation step
  }
}
```

## Frontend Integration Example

```tsx
import { HolographicVolumeViewer } from './components/visualization/HolographicVolumeViewer';
import { useWebSocket } from './contexts/WebSocketContext';

function MyComponent() {
  const { sendMessage } = useWebSocket();
  const [volumeData, setVolumeData] = useState<number[]>([]);
  const [dimensions, setDimensions] = useState({ depth: 0, height: 0, width: 0 });

  useEffect(() => {
    // Subscribe to bulk volume data
    const handleMessage = (message: any) => {
      if (message.type === 'bulk_volume_data') {
        setVolumeData(message.payload.volume_data);
        setDimensions({
          depth: message.payload.depth,
          height: message.payload.height,
          width: message.payload.width
        });
      }
    };

    // Add listener and request data
    // (implementation depends on your WebSocket context)
    
    // Request volume data
    sendMessage({
      type: 'get_bulk_volume'
    });

    return () => {
      // Cleanup listener
    };
  }, []);

  return (
    <HolographicVolumeViewer
      volumeData={volumeData}
      depth={dimensions.depth}
      width={dimensions.width}
      height={dimensions.height}
      threshold={0.01}
    />
  );
}
```

## Visualization Features

- **Color Gradient**: Blue (Boundary) â†’ Red (Deep Bulk)
- **Size Variation**: Deeper voxels appear larger (coarse-grained)
- **Opacity**: Based on voxel intensity
- **3D Navigation**: OrbitControls for rotation/zoom

## Engine Requirements

The backend handler only works when:
1. A `HolographicEngine` is loaded
2. The engine has a valid state with `get_bulk_state()` method

For other engine types, the handler returns a warning message.
